// Copyright 2022 Meador Inge.
// Use of this source code is governed by a MIT
// license that can be found in the LICENSE file.

package cipher

import (
	"bytes"
	"testing"
)

func b(str string) []byte {
	return []byte(str)
}

var testCases = []struct {
	plaintext  []byte
	key        []byte
	ciphertext []byte
}{
	{b(""), b(""), b("")},
	{b("'6y\xa3\xa0\x04\xd6\xa9\x8d\xf5\x14\r\xcc\xd0_\xe9\x93r"), b("\xd7knu\x1b"), b("\xf0]\x17\xd6\xbb\xd3\xbd\xc7\xf8\xee\xc3f\xa2\xa5D>\xf8\x1c")},
	{b("\xd3a\xca>\xc9vO\x7f\xf8\xc4S\t?6\x91W\xdb"), b("\xf8\x17|\xb3\x10\x95\xcd=\xe4}\x00A\xe6\x12\x97\xeay\xb8\x1a$"), b("+v\xb6\x8d\xd9\xe3\x82B\x1c\xb9SH\xd9$\x06\xbd\xa2")},
	{b("Q\x1c\xe3\x01\xba9V\xe9\xe4\xcbe\x9b\x83c\x84\x9f\x18\x0c\xbe\x99\x19"), b("|\xb3\xde\x8a\x11+Jt\xdd\xa8\xb1"), b("-\xaf=\x8b\xab\x12\x1c\x9d9c\xd4\xe70\xbd\x0e\x8e3F\xcaD\xb1")},
	{b("{\xf6Mp\rs\x1bx\xef*I\x8e\xe9\x8d\x19\xa7\xfc"), b("\xed"), b("\x96\x1b\xa0\x9d\xe0\x9e\xf6\x95\x02\xc7\xa4c\x04`\xf4J\x11")},
	{b("\xba\xef\xd1\xb38vt]"), b("\x93\xf7a\xa2\x9b$\xf2\xae\x0c\xce\xb2\xcfQ\x84\x8eZ\xf4\xfb"), b(")\x18\xb0\x11\xa3R\x86\xf3")},
	{b("{\xbeZmx\xd2\x9d\x8bW\x06L&\x9b\xf2"), b("\xca\x86M\x8c\x86"), b("\xb18\x17\xe1\xfe\x18\x1b\xc6\xdb\x80\x86\xa0\xd6~")},
	{b("S\x90CA\xb3"), b("\x86\xcfd\xaf\xfb\xd9\x97ga\xfd.$1\xa2\x04\xcf\r\x1d"), b("\xd5_'\xeeH")},
	{b("\x17f\xef\xeadV"), b("\xcf,"), b("\xd8J \xc6\xabz")},
	{b("\x12\xb4\xe8\x90\x99\xbeJ\x02"), b("A\xcd"), b("Sy\xa9]\xd8s\x0b\xcf")},
	{b("\xd0\x94\x1e\xa6"), b("\x94\xa6\x7fn\xbe\xb7\xc3\x15b"), b("D2a\xc8")},
	{b("\xb8\xb4\x87\x98\x10\xae\xf6'^\xba\xfa\xfc\x16\xf1\xf2*\xfe\x11w"), b("\x92\xef\x06\xca+Y\xe4_\x87\x8ct\xa6\x1e\xd9W :\xceO\x07.{Q"), b("*[\x81R;\xf7\x12x\xd96\x8eZ\x08(\xa5\n\xc4\xdf8")},
	{b("\xf0\xfa\xed\x08\xc0}\xacX\xf3\x0b\xba\xba\x10ZK\x06\xa2K"), b("]y\xdc\xf1\x9a"), b("\xad\x831\xf9Z \xd5\x84\x02\x91\xe7\xc3\xcc\xab\xd1[\xdb\x97")},
	{b(" \xc0[\x81\xcaB{\xc4\xbd\xd2z\x98F\xe6\xbd\x89\xbfZ\xcd\xe7"), b("\xa4\xaf\xcc\x89W\xb6"), b("\x84o\x97\x08\x9d\xf4\xdfkq[-.\xe2Iq\x00\xe8\xeciH")},
	{b("\xf6\x95\x95[\x84_\xb9-\x1ef\xb5\xfc\x0b\rK\x1a\x82a;"), b("9\xd7!\x84\xa9"), b("\xcfB\xb4\xdf-fn\x0c\x9a\xcf\x8c+*\x89\xe2#U@\xbf")},
	{b("lDL\x17OQ\xed"), b("\xdb\xec\xe1\x84\xafn."), b("\xb7\xa8\xad\x93\xe0?\xc3")},
	{b("\xff\xf6\x1f\xd0\xf9\x86\xcf\xc5\r\x16"), b("7%S\xb5\x143\xd3\x93!\x92"), b("\xc8\xd3Le\xed\xb5\x1cV,\x84")},
	{b("\xae\xf2#\x05\x9d6\x82\x04Co\xab\xeb\x1d"), b("\xc96.\x97\xb4\xf6\xda,\xbb\xaf\xe7\x96N}\x06I\xc6v^U"), b("g\xc4\r\x92)\xc0X(\xf8\xc0L}S")},
	{b("\xfa\x17\x9b\x02\x08\x94\xf7\xcbe\x94\xfcL(r\x08^\x8a\x9f\x91\x1f"), b("\xadx\x86\x17\xb8t"), b("Wo\x1d\x15\xb0\xe0Z\xb3\xe3\x83D8\x85\n\x8eI2\xeb<g")},
	{b("\xebY\x89`l\x02J\xa0>I"), b("qi[\xfd\xe7v4\xdfjv^r\x97\xf1yN\xa3\xd4\x0c\xc4\xa1"), b("\x9a0\xd2\x9d\x8bt~\x7fT?")},
	{b("\xe2Jo\xad"), b("\xab\xd6\x05\xd8"), b("I\x9cju")},
	{b("\xbb\x89D\xae\xba\xc8\x02\xa4]%\t\t"), b("\x8d\xbd\xe1"), b("64\xa5#\x07)\x8f\x19\xbc\xa8\xb4\xe8")},
	{b("w>\x86X\n\x9e:\xb3W"), b("\xb3\xd2`k\x9d\xc50\x94q"), b("\xc4\xec\xe63\x97[\n'&")},
	{b("*\x9dA\x13\n\xc5vV\xf4\xae\x8fO!\x17e"), b("\xc8\x84I\xfaP\xae\xec0\xaa\xbd\x94j\x1a"), b("\xe2\x19\x08\xe9Zk\x9af^\x13\x1b%;\xdf\xe1")},
	{b("\xabj"), b("\xd9IW\xae\\\x89\x90\x91\xd1|H\xbeoJRz\xeb4"), b("r#")},
	{b("\x88`\xa8\xb8\xdcXTfU\x95\xd9\x1b"), b("\xc8=+\xba"), b("@]\x83\x02\x14e\x7f\xdc\x9d\xa8\xf2\xa1")},
	{b("\xe6\x9b\xd6eK r\xe6\x87"), b("\x97\x1f\x01\xca\xeb\xf8\xdc"), b("q\x84\xd7\xaf\xa0\xd8\xaeq\x98")},
	{b("\xdd\x8bQV\xf8U^\xb0\t\xb2\x0b\xa1K\x92\x87\xe2@\nA\x178"), b("\xb6\x1e\x9f"), b("k\x95\xce\xe0\xe6\xca\xe8\xae\x96\x04\x15>\xfd\x8c\x18T^\x95\xf7\t\xa7")},
	{b("\x15\x9cJ\xce\x86\xee\xca\xb7-\xdcm'\xd2\x08\xdc\xc3"), b("t\xb83\x1d-[\xd4F^\xf4\x93T\xcd"), b("a$y\xd3\xab\xb5\x1e\xf1s(\xfes\x1f|d\xf0")},
	{b("9I`\x87\x17\xb0et\x9c\x81B#\xf9]\xd5O\x82_0"), b("\xeeH"), b("\xd7\x01\x8e\xcf\xf9\xf8\x8b<r\xc9\xack\x17\x15;\x07l\x17\xde")},
	{b("^\x0c\xa6p\xbc\xac6=@=\xed"), b("^n\x90\xfa$\x84\x9e\x17\xe3\x888b"), b("\x00b6\x8a\x98(\xa8*\xa3\xb5\xd5")},
	{b("\x0f\xf5\x84"), b(" }B\xb20k\xef\x86\xd8\xc7"), b("/\x88\xc6")},
	{b("\x90\xd1\xdfO\xe0\xc9\xbb4j"), b("\xfe\xaf\x8bY\xe8Z\xc0]hBB\xc2mTx/\xb4V*\xfd\x00f"), b("n~T\x16\x08\x93{i\x02")},
	{b("\xca\x01\x082\x14\xb5af\xde\xfc__J0\xdb\x84\x82|"), b("\x9fXM>\xf3*\xd2[^}\x0e\xbe3"), b("UYE\x0c\xe7\x9f\xb3=\x80\x81Q\xe1y\xaf\x83\xc9\xbc\x8f")},
	{b("YCW\x16P\x9f[+\x8cG\xfb\xe5C\xee\xf0\x1d\xac\xdb\xae"), b("\xd2\xb91\x94y\xf9\xdb\x02\x05\xeb\xa8$\xd3n\xfbR"), b("\x8b\xfaf\x82)f\x80)\x89\xacS\xc1\x90\x80\x0bO~b\x9f")},
	{b("\xb8\xfd#\xf8\xe8\x98;9\x0f\x1e\xef\xf9\xe3\x9a\xf7"), b("\x07\x9b>V\xcd\xdc\t\x10|\x04\xdd"), b("\xbff\x1d\xae%D2)s\x1a2\xfex\xa4\xa1")},
	{b("B\xe1\x08\x08\xd6\x1e\xb3\xb6\xceD\x9c\xcc\x1ff\x12\xee\x92\x16\xc3\xf2;\xc2-"), b("\xa1,;\xd2\x11\x17\x1ab{u\xfb\xeb\xa4\xba\x13n\xa6\xaf\xc6C\xad\x02"), b("\xe3\xcd3\xda\xc7\t\xa9\xd4\xb51g'\xbb\xdc\x01\x804\xb9\x05\xb1\x96\xc0\x8c")},
	{b("\xd3\xc8Y\xee\x057\xdd\xee\x10\xb3u\xcb\x0eh@\xf6*\xa0<^\xd9\xb2\xd6"), b("\x14\x18\xe4\xdd\xb5rw\xf1]M\rPO\xd9\xf5"), b("\xc7\xd0\xbd3\xb0E\xaa\x1fM\xfex\x9bA\xb1\xb5\xe22D\xe1\xeb\xab\xc5'")},
	{b("q\xa0\xcc\xf1\xb8\xbfj\x03\xb3\rc~\xe70"), b("\xc8\x03\x05\x83\x8e]\x0c"), b("\xb9\xa3\xc9r6\xe2f\xcb\xb0\x08\xe0\xf0\xba<")},
	{b("\x82\x17`?\xbb\x99\xfa4S\x9dj\x85\xa4c\xd2"), b("\x92\xff\xa7\x87\xd6}\xc1\xbd\x1a\xe9"), b("\x10\xe8\xc7\xb8m\xe4;\x89It\xf8z\x03\xe4\x04")},
	{b("\xe8'&\xf2\xb3!;"), b("\xa2.@o)\xdd\r\xd4\xbb\xba\x04\xa7,\xb6K\x1b\xf2t\xfaF"), b("J\tf\x9d\x9a\xfc6")},
	{b("\xc6"), b("\x82\x1c"), b("D")},
	{b(".\xaf\x80\x15\n\xa21i\xe8\x8e\xd0"), b("\xb0\xb1B\xc2=\x91\xba\x19\xdcr\xd0`\xca6\x95C\xc9\xa2"), b("\x9e\x1e\xc2\xd773\x8bp4\xfc\x00")},
	{b("\xebg\x18By\x05\x15\xe1\xa1]\xcf\\B"), b("+\\\x1f?D"), b("\xc0;\x07}=.I\xfe\x9e\x19\xe4\x00]")},
	{b("\xf7\xa5\x96\xd65\xb6@\x98\xbd\xda"), b("\xbdP\xea\x99l\xd0\x02\xe1\x92\xca\xd9bn\x15\x86\x04*\x8e\x88I~\xf0\x08"), b("J\xf5|OYfBy/\x10")},
	{b("m\x8f\xe8\x1dq\xcf"), b("\x17y\xc6\xaf]\\\xcbw\xbc:\xf8\xf6RS\xf5\xeei{\xd6\x1e)."), b("z\xf6.\xb2,\x93")},
	{b("&\x85\x8b\xf4E"), b("\xd7\x8f\xa8lb\x8a\x85\x9e\x98\xa9R\x99\x88\xf2\x88,3A"), b("\xf1\n#\x98'")},
	{b("\t\xf5\xe8\x05?\xe8\xd8q1\xf0\xa7j\xd8k"), b("\xbf$\x92\xb91\xe57|\xd7\xee\xee\xeb\xa6F\xf4iS[\x02"), b("\xb6\xd1z\xbc\x0e\r\xef\r\xe6\x1eI\x81~-")},
	{b("(\x06\xea\x82{#\x8f\xe6"), b("\xb6\xfc\xe3\x84L\xa2T\xc5\xfe\x86\xe8\x10"), b("\x9e\xfa\t\x067\x81\xdb#")},
	{b("YZ\x80\x03\xc0"), b("(M\x90&"), b("q\x17\x10%\xe8")},
	{b("\xbe\xf1\xaa?R\x94"), b("\xaa\xbc\\"), b("\x14M\xf6\x95\xee\xc8")},
	{b("^'\xca2\x16\xe4\x12\x1dM"), b("]\xe2\xc8\x0e9>\xeb\x81\x0f\x90}\x01\xcd\xef\xb0_\x94\x97\xae\xb9"), b("\x03\xc5\x02</\xda\xf9\x9cB")},
	{b("\x17+\x97\xf1\xcb\xa5HI\x0bP\x94\x1c"), b(" \x0cR\xdc\xe5\xdbS\xcc5p1y\xe2K\xe4\xe4X\x82V>\xd7F"), b("7'\xc5-.~\x1b\x85> \xa5e")},
	{b("\xb6\xdeT\x04\xe6\xeb"), b("\xc2\x81p\x89-\x90m]a\xd5\x9d\x8bL_8K\x1c\x9fe\x83\xc9"), b("t_$\x8d\xcb{")},
	{b("C\xf3\xdd\xcf\xe0\xff\x11\x82\x85\xa2~\xe6\x00+\xf5\x04\xd8PM"), b("\xcc\xd4\xe3N\x06\xff\x1f\xd6\xb9G\xd7\x94\x94\xc22\xcb4\xb8\xaa0\x16"), b("\x8f'>\x81\xe6\x00\x0eT<\xe5\xa9r\x94\xe9\xc7\xcf\xec\xe8\xe7")},
	{b("\xaa\xdd\x86o\xba\xf5\x99\xe3\xaf\xbd!\x0b\x94\x179R"), b("Z\xfc\x85\xf9S3B\x07\xf1C\x80\xd74\x9c\xa3\x8b\x90\xad\xb1\xfc\x12"), b("\xf0!\x03\x96\xe9\xc6\xdb\xe4^\xfe\xa1\xdc\xa0\x8b\x9a\xd9")},
	{b("\x00\x8e3\x16#\xa6\x01\xf8"), b("j\x93\r0\xdc\xff=\xa4\x11\xdfc\x86\x83v^\xe7\x8b<\x82\xd4\xc12"), b("j\x1d>&\xffY<\\")},
	{b("\x96\xb1\xfb\x95\xa3\x87\x10\x03|-\x1ef9+\x01\xb0m"), b("\x88\xdf(\xa5\n\xe4\xfe\xc6\x87^:\xb4t"), b("\x1en\xd30\xa9c\xee\xc5\xfbs$\xd2M\xa3\xde\x98\xc8")},
	{b("@"), b("\x87\xce\x17tt\x1b\x9f\xa6\xa3\xe8\x0e"), b("\xc7")},
	{b("\xb0\xf5"), b("q\xe0\x93\xc7"), b("\xc1\x15")},
	{b("\xd5\x06\xff\xb9\xad\x86\x0cV\x82.A\xa9\x13\x13"), b("\x99s\xb49\x8d\xb7\xfd\x1c"), b("LuK\x80 1\xf1J\x1b]\xf5\x90\x9e\xa4")},
	{b("\xediP\xaaj\xcd"), b("\xe7\xe9\xa0S?r\x86!\n\xbd"), b("\n\x80\xf0\xf9U\xbf")},
	{b("w\xf8|\xd8"), b("g* a5\xa9]"), b("\x10\xd2\\\xb9")},
	{b("`A}\xe1"), b("\xef\xa9\xe2\xcd/s\xb1\xf6\xf2\xafc\xd2':\nRd{"), b("\x8f\xe8\x9f,")},
	{b("6\xa4\x8c\x08Y%\xa4L\xdf"), b("Z\xe2\x15-\x15\x8f\xa3"), b("lF\x99%L\xaa\x07\x16=")},
	{b("\xb9\xd0\xaf\xd1%"), b("/\x81y\x90\x98\xfd\xec+6\x80\xad\xeb\xea"), b("\x96Q\xd6A\xbd")},
	{b("\xe7U\x12?\x9a{4"), b("\x81\x1d\xe7"), b("fH\xf5\xbe\x87\x9c\xb5")},
	{b(" \x14\x97\xb9\xf8:\x95~\xf7\x9eb\xd4\x88\xce,<"), b("\x91\xf8L\x1a\xacK\t\x03\xde\xac\xc5-\rg\xf1"), b("\xb1\xec\xdb\xa3Tq\x9c})2\xa7\xf9\x85\xa9\xdd\xad")},
	{b("\xd7eE\xaa\x03u'\xbd\x02\x98\xd6\xf3gCl$$\xe2\xbc"), b("B\xd7st\xc0\xb4\x0b|B\x85t\xbc\xd9<\xfc\xc6"), b("\x95\xb26\xde\xc3\xc1,\xc1@\x1d\xa2O\xbe\x7f\x90\xe2f5\xcf")},
	{b("{|i\x8a_ 2"), b("\x1a\xce\xf60"), b("a\xb2\x9f\xbaE\xee\xc4")},
	{b("\x82F\xc5 \x94"), b("w\xd8\x1f\xe7\x04v"), b("\xf5\x9e\xda\xc7\x90")},
	{b("(\xda\x904\xa9\x9b\x01"), b("\x18\x10\x06"), b("0\xca\x96,\xb9\x9d\x19")},
	{b("\xcaW\xe2\xc5\xc0#"), b("\xd1\xa2\xa6|"), b("\x1b\xf5D\xb9\x11\x81")},
	{b("\xa8m\xdb\xc1\xc5"), b("\xf9\xa0J\xd3\xba\x06/\x81\xc1\x97el\x11\x17\xb4\xeb5"), b("Q\xcd\x91\x12\x7f")},
	{b("\x0c\x00\xbfw"), b("\xcey\x9f\xbaW\xf0"), b("\xc2y \xcd")},
	{b("\xfc"), b("\xf9T\xf7\x8c\xdc\xc1\xa8\xba9\xad\x01"), b("\x05")},
	{b("\xbe,\xb1\xc9\xd9\r\x7ff\xa7\x88\xb1\x01\x1d\xad\x04\xd7~*<"), b("\xfc^\x99\xa6\xe7\n\x85\x9c\x068\x8d&;"), b("Br(o>\x07\xfa\xfa\xa1\xb0<'&QZN\xd8\xcd6")},
	{b("G\x80\xb9\x96\xf7/\xccT\xd73\x18\xaf\xdaj\n\ne"), b("f\x87\x02\xa2"), b("!\x07\xbb4\x91\xa8\xce\xf6\xb1\xb4\x1a\r\xbc\xed\x08\xa8\x03")},
	{b("\xa4\xbb\xac\x9f\xd1\x8b\xcfG\xdf"), b("o\xd0|27\x8c"), b("\xcbk\xd0\xad\xe6\x07\xa0\x97\xa3")},
	{b("H\xf9\xe8\x87<\xab\x87\x04\xbc_\xba\x15w\xf0\xd9\xfb'\x1c"), b("\xb7c\xd9\x8a\x91\xfad\x0c\xdb\xf0\xc9\xfc6\xd4H\xb2\xd8_\xa0{\xa6g"), b("\xff\x9a1\r\xadQ\xe3\x08g\xafs\xe9A$\x91I\xffC")},
	{b("}J"), b("\xa1\x85\xcc\x07\x13\x92\xf5\xd8"), b("\xdc\xcf")},
	{b("\xaf\xcb\x1e\xbfkzF\xbd\xc4"), b("\xef[\x05XU\xa1gX|P{G\x16\x9d<\xbf\xad\x08'\xa4\x0f\xa0"), b("@\x90\x1b\xe7>\xdb!\xe5\xb8")},
	{b("^\xc4E\xc1\xcb\x90"), b("\xb4\x93!\xa0\xb1\x12\x1d\xf0\x17o2t`\x8a"), b("\xeaWdaz\x82")},
	{b("3Ak\x9br\x05\x8f\r\x1fU;\x08C\xf8\x92\xb2j\x8d"), b("\x9eEYc\xdbs\n\x14(\xc7e\x1dd"), b("\xad\x042\xf8\xa9v\x85\x197\x92^\x15'f\xd7\xeb\tV")},
	{b("|\xa4\x08\xaa\x02\xa5C(\xa4\xd2\xdd5\xa7Khl\x17\x9c\xe7"), b("\x8b\x04\x9c=\x92\xc1\xa2g\x1d\xea:\xa4k\xe6m\xbf\xfa/A"), b("\xf7\xa0\x94\x97\x90d\xe1O\xb98\xe7\x91\xcc\xad\x05\xd3\xed\xb3\xa6")},
	{b("<y\xe6\xd7^\x89\xa8\xb0!\xf9\xa9\xfdb3\xb9%\xb3K~"), b("\x9ec\x04x#b\xa4+\xd4,9R\x89?\xa5r\xcbwY"), b("\xa2\x1a\xe2\xaf}\xeb\x0c\x9b\xf5\xd5\x90\xaf\xeb\x0c\x1cWx<'")},
	{b("\x12\x81"), b("\x08\x9aQ\x91j\xac\xed\x96\x94\xe8{\xb3\x0c\xaf\x88\xdc\x11\x98\x88\n"), b("\x1a\x1b")},
	{b("\x13\xd1UI\xe6\x94\xf9X\xaa\x9f\x83|)\x10\x8d\xebPG\xe4){\x1f"), b("\xe9*\xef\x96]\x07\xc1N\xe4\xbfFJ\x04\xe2G\xa3"), b("\xfa\xfb\xba\xdf\xbb\x938\x16N \xc56-\xf2\xcaH\xb9m\x0b\xbf&\x18")},
	{b("L(b+\xf4\xba\x15\xcd\x9a\x8ei\x93\x1c\xbc\x07\xbf"), b("\x0e\xe4\x15\x82\xfc\xb7\x85\xf3\xf8{\xd4\xd1\xee"), b("B\xccw\xa9\x08\r\x90>b\xf5\xbdB\xf2\xb2\xe3\xaa")},
	{b("\x844?kY\xbe"), b("\x9e\xa4\x19\x02"), b("\x1a\x90&i\xc7\x1a")},
	{b("\xe6\x1a\xf8"), b("\n\n\xcfIA\xaa\xdeOi\xda1\xeaX\xd4\x9f"), b("\xec\x107")},
}

func TestSymmetricEncryption(t *testing.T) {
	for _, cipherName := range SymmetricCipherNames() {
		cipher := NewSymmetricCipher(cipherName)
		for _, test := range testCases {
			ciphertext := cipher.Encrypt(test.plaintext, test.key)
			plaintext := cipher.Decrypt(ciphertext, test.key)
			if bytes.Compare(test.plaintext, plaintext) != 0 {
				t.Fatalf("Decrypt(Encrypt('%v')) != '%v'", test.plaintext, test.plaintext)
			}
		}
	}
}
